version: "3.8"
services:
  hazelcast:
    environment:
      - HZ_CLUSTERNAME=deft-cluster
    image: hazelcast/hazelcast:4.2.2
    scale: 1
  
  # ovs_docker:
  #   build: ./ovs/
  #   depends_on:
  #     - hz_client
  #   volumes:
  #     - /var/run/docker.sock:/var/run/docker.sock
  #     - /var/lib/openvswitch:/var/lib/openvswitch

  hz_client_1:
    build: ./test/
    depends_on:
      - hazelcast
    scale: 1
    volumes:
      - ./results:/code/results

  hz_client_2:
    build: ./test/
    depends_on:
      - hazelcast
    scale: 1
    volumes:
      - ./results:/code/results

  stamper:
    build: ./stamper/

  nginx:
    container_name: nginx
    ports:
      - 8080:8080/udp
    volumes:
      - ./nginx/nginx.conf:/etc/nginx/nginx.conf
    depends_on:
      - stamper
    image: nginx




